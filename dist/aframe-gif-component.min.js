(()=>{var t={231:(t,e)=>{e.O=function(t,e,a){var r=0,i=[],s=0,n=null,o=null,_=[],c=0;if(71!==t[0]||73!==t[1]||70!==t[2]||56!==t[3]||57!==t[4]&&55!==t[4]||97!==t[5])a&&a("parseGIF: no GIF89a");else{r+=13+ +!!(128&t[10])*Math.pow(2,1+(7&t[10]))*3;for(var h=t.subarray(0,r);t[r]&&59!==t[r];){var l=r,u=t[r];if(33===u){var f=t[++r];if(-1===[1,254,249,255].indexOf(f)){a&&a("parseGIF: unknown label");break}for(249===f&&i.push(10*(t[r+3]+(t[r+4]<<8))),255===f&&(c=t[r+15]+(t[r+16]<<8));t[++r];)r+=t[r];249===f&&(n=t.subarray(l,r+1))}else{if(44!==u){a&&a("parseGIF: unknown blockId");break}for(r+=9,r+=1+ +!!(128&t[r])*(3*Math.pow(2,1+(7&t[r])));t[++r];)r+=t[r];o=t.subarray(l,r+1);var d={disposalMethod:n[3],blob:URL.createObjectURL(new Blob([h,n,o]))};_.push(d)}r++}}if(_.length){var p=document.createElement("canvas"),m=function t(a){var r=new Image;r.onload=function(a,r){s++,_[r]=this,s===_.length?e&&e(i,c,_):t(++r)}.bind(r),r.src=p.toDataURL("image/gif")};!function(){for(var t=0;t<_.length;t++){var e=new Image;e.onload=function(t,a){0===a&&(p.width=e.width,p.height=e.height),s++,_[a]=this,s===_.length&&(s=0,m())}.bind(e,null,t),e.src=_[t].blob,e.disposalMethod=_[t].disposalMethod}}()}}}},e={};function a(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,a),s.exports}(()=>{"use strict";var t=a(231);function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";var r=AFRAME.utils.srcLoader.parseUrl,i=AFRAME.utils.debug;i.enable("shader:gif:*");var s=i("shader:gif:warn"),n=i("shader:gif:debug"),o={};function _(t,e){return{status:"error",src:e,message:t,timestamp:Date.now()}}AFRAME.registerShader("gif",{schema:{color:{type:"color"},fog:{default:!0},src:{default:null},autoplay:{default:!0}},init:function(t){return n("init",t),this.__cnv=document.createElement("canvas"),this.__cnv.width=2,this.__cnv.height=2,this.__ctx=this.__cnv.getContext("2d"),this.__texture=new THREE.Texture(this.__cnv),t.repeat&&(this.__texture.wrapS=THREE.RepeatWrapping,this.__texture.wrapT=THREE.RepeatWrapping,this.__texture.repeat.set(t.repeat.x,t.repeat.y)),this.__material={},this.__reset(),this.material=new THREE.MeshBasicMaterial({map:this.__texture}),this.el.sceneEl.addBehavior(this),this.material},update:function(t){return n("update",t),this.__updateMaterial(t),this.__updateTexture(t),this.material},tick:function(t){this.__frames&&!this.paused()&&Date.now()-this.__startTime>=this.__nextFrameTime&&this.nextFrame()},__updateMaterial:function(t){var e=this.material,a=this.__getMaterialData(t);Object.keys(a).forEach((function(t){e[t]=a[t]}))},__getMaterialData:function(t){return{fog:t.fog,color:new THREE.Color(t.color)}},__setTexture:function(t){n("__setTexture",t),"error"===t.status?(s("Error: ".concat(t.message,"\nsrc: ").concat(t.src)),this.__reset()):"success"===t.status&&t.src!==this.__textureSrc&&(this.__reset(),this.__ready(t))},__updateTexture:function(t){var e=t.src,a=t.autoplay;"boolean"==typeof a?this.__autoplay=a:void 0===a&&(this.__autoplay=!0),this.__autoplay&&this.__frames&&this.play(),e?this.__validateSrc(e,this.__setTexture.bind(this)):this.__reset()},__validateSrc:function(t,a){var i,s=r(t);if(n("__validateSrc",t,s),s)return this.__getImageSrc(s,a),void n("__validateSrc: ".concat(s," validated"));n("__validateSrc URL: ".concat(s," validation failed."));var c=this.__validateAndGetQuerySelector(t);if(c&&"object"===e(c)){if(c.error)i=c.error;else{var h=c.tagName.toLowerCase();if("video"===h)t=c.src,i="For video, please use `aframe-video-shader`";else{if("img"===h)return void this.__getImageSrc(c.src,a);i="For <".concat(h,"> element, please use `aframe-html-shader`")}}if(i){n("__validateSrc: ".concat(i," validation failed."));var l=o[t],u=_(i,t);l&&l.callbacks?l.callbacks.forEach((function(t){return t(u)})):a(u),o[t]=u}}},__getImageSrc:function(e,a){var r=this;if(n("__getImageSrc",e),e!==this.__textureSrc){n("Source isn't same as previous.");var i=o[e];if(i&&i.callbacks){if(i.src)return n("Already had source data, calling cb"),void a(i);if(i.callbacks)return void i.callbacks.push(a)}else n("Didn't already have source."),(i=o[e]={callbacks:[]}).callbacks.push(a);var s=new Image;s.crossOrigin="Anonymous",n("Created tester image, time to attach loader"),s.addEventListener("load",(function(a){n("Image ".concat(e," loaded.")),r.__getUnit8Array(e,(function(a){a?(n("Should parse gif for ".concat(e," next")),(0,t.O)(a,(function(t,a,r){n("Parsing Gif for ".concat(e));var s={status:"success",src:e,times:t,cnt:a,frames:r,timestamp:Date.now()};i.callbacks&&(i.callbacks.forEach((function(t){return t(s)})),o[e]=s)}),(function(t){n("Error parsing gif for ".concat(e,", ").concat(t)),c(t)}))):c("This is not gif. Please use `shader:flat` instead")}))})),s.addEventListener("error",(function(t){return c("Could be the following issue\n - Not Image\n - Not Found\n - Server Error\n - Cross-Origin Issue")})),s.src=e}function c(t){var a=_(t,e);i.callbacks&&(i.callbacks.forEach((function(t){return t(a)})),o[e]=a)}},__getUnit8Array:function(t,e){if("function"==typeof e){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="arraybuffer",a.addEventListener("load",(function(t){for(var a=new Uint8Array(t.target.response),r=a.subarray(0,4),i="",s=0;s<r.length;s++)i+=r[s].toString(16);"47494638"===i?e(a):e()})),a.addEventListener("error",(function(t){n(t),e()})),a.send()}},__validateAndGetQuerySelector:function(t){n("Validating as querySelector",t);try{var e=document.querySelector(t);return n("QuerySelector element",e),e||{error:"No element was found matching the selector"}}catch(t){return n("QuerySelector Failed",t),{error:"no valid selector"}}},pause:function(){n("pause"),this.__paused=!0},play:function(){n("play"),this.__paused=!1},togglePlayback:function(){this.paused()?this.play():this.pause()},paused:function(){return this.__paused},nextFrame:function(){for(this.__draw();Date.now()-this.__startTime>=this.__nextFrameTime;)this.__nextFrameTime+=this.__delayTimes[this.__frameIdx++],(this.__infinity||this.__loopCnt)&&this.__frameCnt<=this.__frameIdx&&(this.__frameIdx=0)},__clearCanvas:function(){this.__ctx.clearRect(0,0,this.__width,this.__height)},__draw:function(){if(0!=this.__frameIdx){var t=this.__frames[this.__frameIdx-1];8!=t.disposalMethod&&9!=t.disposalMethod||this.__clearCanvas()}else this.__clearCanvas();var e=this.__frames[this.__frameIdx];void 0!==e&&(this.__ctx.drawImage(e,0,0,this.__width,this.__height),this.__texture.needsUpdate=!0)},__ready:function(t){var e=t.src,a=t.times,r=t.cnt,i=t.frames;n("__ready"),this.__textureSrc=e,this.__delayTimes=a,r?this.__loopCnt=r:this.__infinity=!0,this.__frames=i,this.__frameCnt=a.length,this.__startTime=Date.now(),this.__width=THREE.MathUtils.floorPowerOfTwo(i[0].width),this.__height=THREE.MathUtils.floorPowerOfTwo(i[0].height),this.__cnv.width=this.__width,this.__cnv.height=this.__height,this.__draw(),this.__autoplay?this.play():this.pause()},__reset:function(){this.pause(),this.__clearCanvas(),this.__startTime=0,this.__nextFrameTime=0,this.__frameIdx=0,this.__frameCnt=0,this.__delayTimes=null,this.__infinity=!1,this.__loopCnt=0,this.__frames=null,this.__textureSrc=null}})})()})();